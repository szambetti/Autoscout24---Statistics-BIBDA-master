*;
* IMPUTE VARIABLE: Porte;
*;
length IMP_Porte 8;
format IMP_Porte BEST.;
label IMP_Porte = 'Imputed: Porte';
IMP_Porte = Porte;
if missing(IMP_Porte) then do;
****************************************************************;
****** DECISION TREE SCORING CODE ******;
****************************************************************;
****** LENGTHS OF NEW CHARACTER VARIABLES ******;
LENGTH I_Porte $ 12;
LENGTH _WARN_ $ 4;
****** LABELS FOR NEW VARIABLES ******;
label P_Porte5 = 'Previsto: Porte=5';
label P_Porte3 = 'Previsto: Porte=3';
label Q_Porte5 = 'P non corretto: Porte=5';
label Q_Porte3 = 'P non corretto: Porte=3';
label I_Porte = 'In: Porte';
label U_Porte = 'Non normalizzata in: Porte';
label _WARN_ = 'Avvertimenti';
****** TEMPORARY VARIABLES FOR FORMATTED VALUES ******;
LENGTH _ARBFMT_12 $ 12;
DROP _ARBFMT_12;
_ARBFMT_12 = ' ';
/* Initialize to avoid warning. */
LENGTH _ARBFMT_20 $ 20;
DROP _ARBFMT_20;
_ARBFMT_20 = ' ';
/* Initialize to avoid warning. */
LENGTH _ARBFMT_23 $ 23;
DROP _ARBFMT_23;
_ARBFMT_23 = ' ';
/* Initialize to avoid warning. */
LENGTH _ARBFMT_14 $ 14;
DROP _ARBFMT_14;
_ARBFMT_14 = ' ';
/* Initialize to avoid warning. */
LENGTH _ARBFMT_17 $ 17;
DROP _ARBFMT_17;
_ARBFMT_17 = ' ';
/* Initialize to avoid warning. */
****** ASSIGN OBSERVATION TO NODE ******;
DROP _BRANCH_;
_BRANCH_ = -1;
_ARBFMT_20 = PUT( Modello , $20.);
%DMNORMIP( _ARBFMT_20);
IF _ARBFMT_20 IN ('FORTWO' ,'500' ,'500C' ,'420' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_20 IN ('Q3' ,'KONA' ,'E-TRON' ,'DS 3 CROSSBACK' ,'A4' ,
'LEAF' ,'208' ,'CORSA' ,'PARTNER' ,'KANGOO' ,'NEW PANDA' ,'PANDA' ,
'YPSILON' ,'TWINGO' ,'DUSTER' ,'500X' ,'CAPTUR' ,'TIVOLI' ,'RENEGADE' ,
'COMPASS' ,'STONIC' ,'SPORTAGE' ,'GRANDLAND X' ,'OUTLANDER' ,'CROSSLAND X' ,
'TIPO' ,'CLIO' ,'SANDERO' ,'GIULIETTA' ,'FIESTA' ,'C3' ,'VITARA' ,'500L' ,
'Q5' ,'PUMA' ,'NX 300' ,'UX 250H' ,'X1' ,'C-HR' ,'CX-30' ,'3008' ,'X3' ,
'PASSAT VARIANT' ,'508' ,'520' ,'A6' ,'LEON' ,'COROLLA' ,'CAYENNE' ,'GOLF' ,
'YARIS' ,'A5' ,'A3' ,'UP!' ,'POLO' ,'T-ROC' ,'CLA 200' ,'ARONA' ,'STELVIO' ,
'ATECA' ,'KADJAR' ,'KAMIQ' ,'QASHQAI' ,'X-TRAIL' ,'WRANGLER' ,'T-CROSS' ,
'Q2' ,'TIGUAN' ,'OCTAVIA' ,'MEGANE' ,'TALISMAN' ,'ASTRA' ,'FOCUS' ,
'GOLF VARIANT' ,'308' ,'PASSAT' ,'318' ,'C4 CACTUS' ,'IBIZA' ,'SCALA' ,
'GIULIA' ,'E-PACE' ,'COMBO' ,'118' ,'TUCSON' ,'GRAND C4 SPACETOURER' ,
'SCENIC' ,'DOBLO' ,'CADDY' ,'B 180' ,'218' ,'216' ,'TOURAN' ,'FIORINO' ,
'C 220' ,'L200' ,'COOPER D COUNTRYMAN' ,'CHEROKEE' ,'INSIGNIA' ,
'COOPER D CLUBMAN' ,'A4 ALLROAD' ,'320' ,'730' ,'ESPACE' ,'C4 SPACETOURER' )
THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(Carrozzeria ) THEN DO;
_ARBFMT_23 = PUT( Carrozzeria , $23.);
%DMNORMIP( _ARBFMT_23);
IF _ARBFMT_23 IN ('CITY CAR' ,'CABRIO' ,'434F5550C383C2A9'x ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_23 IN ('BERLINA' ,'ALTRO' ,'SUV/FUORISTRADA/PICK-UP' ,
'STATION WAGON' ,'MONOVOLUME' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(Posti_a_sedere ) THEN DO;
_ARBFMT_12 = PUT( Posti_a_sedere , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('4' ,'2' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('5' ,'3' ,'7' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 2;
IF _BRANCH_ EQ 1 THEN DO;
_ARBFMT_12 = PUT( Posti_a_sedere , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('5' ) THEN DO;
P_Porte5 = 0.93333333333333;
P_Porte3 = 0.06666666666666;
Q_Porte5 = 0.93333333333333;
Q_Porte3 = 0.06666666666666;
I_Porte = '5';
U_Porte = 5;
END;
ELSE DO;
IF NOT MISSING(REP_Cilindrata ) THEN DO;
_BRANCH_ = -1;
_ARBFMT_12 = PUT( Classe_emissioni , $12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('ELETTRICA' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('EURO 6' ,'EURO 6D-TEMP' ,'EURO 6D' ) THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(REP_Cilindrata ) THEN DO;
IF REP_Cilindrata < 437.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 437.5 <= REP_Cilindrata THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(Alimentazione ) THEN DO;
_ARBFMT_17 = PUT( Alimentazione , $17.);
%DMNORMIP( _ARBFMT_17);
IF _ARBFMT_17 IN ('ELETTRICA' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_17 IN ('BENZINA' ,'DIESEL' ,'ELETTRICA/BENZINA' ,
'GPL' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
_ARBFMT_12 = PUT( Classe_emissioni , $12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('EURO 6' ,'EURO 6D-TEMP' ,'EURO 6D' ) THEN DO;
P_Porte5 = 0;
P_Porte3 = 1;
Q_Porte5 = 0;
Q_Porte3 = 1;
I_Porte = '3';
U_Porte = 3;
END;
ELSE DO;
IF NOT MISSING(REP_price ) AND
REP_price < 12115 THEN DO;
P_Porte5 = 0.6;
P_Porte3 = 0.4;
Q_Porte5 = 0.6;
Q_Porte3 = 0.4;
I_Porte = '5';
U_Porte = 5;
END;
ELSE DO;
P_Porte5 = 0;
P_Porte3 = 1;
Q_Porte5 = 0;
Q_Porte3 = 1;
I_Porte = '3';
U_Porte = 3;
END;
END;
END;
ELSE DO;
P_Porte5 = 0.16666666666666;
P_Porte3 = 0.83333333333333;
Q_Porte5 = 0.16666666666666;
Q_Porte3 = 0.83333333333333;
I_Porte = '3';
U_Porte = 3;
END;
END;
ELSE DO;
P_Porte5 = 0.42857142857142;
P_Porte3 = 0.57142857142857;
Q_Porte5 = 0.42857142857142;
Q_Porte3 = 0.57142857142857;
I_Porte = '3';
U_Porte = 3;
END;
END;
END;
ELSE DO;
_ARBFMT_23 = PUT( Carrozzeria , $23.);
%DMNORMIP( _ARBFMT_23);
IF _ARBFMT_23 IN ('CABRIO' ,'434F5550C383C2A9'x ) THEN DO;
_BRANCH_ = -1;
_ARBFMT_12 = PUT( Posti_a_sedere , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('5' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('4' ) THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(REP_price ) THEN DO;
IF REP_price < 19625 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 19625 <= REP_price THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(REP_Consumo_Carburante_Totale ) THEN DO;
IF 6.8 <= REP_Consumo_Carburante_Totale THEN DO;
_BRANCH_ = 1;
END;
ELSE IF REP_Consumo_Carburante_Totale < 6.8 THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 1;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 2;
IF _BRANCH_ EQ 1 THEN DO;
P_Porte5 = 0.75;
P_Porte3 = 0.25;
Q_Porte5 = 0.75;
Q_Porte3 = 0.25;
I_Porte = '5';
U_Porte = 5;
END;
ELSE DO;
P_Porte5 = 0.02564102564102;
P_Porte3 = 0.97435897435897;
Q_Porte5 = 0.02564102564102;
Q_Porte3 = 0.97435897435897;
I_Porte = '3';
U_Porte = 3;
END;
END;
ELSE DO;
_ARBFMT_12 = PUT( Posti_a_sedere , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('2' ,'3' ) THEN DO;
_BRANCH_ = -1;
IF NOT MISSING(REP_Cilindrata ) AND
REP_Cilindrata < 1308 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(REP_Cilindrata ) AND
1308 <= REP_Cilindrata THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(Per_neopatentati ) THEN DO;
_ARBFMT_12 = PUT( Per_neopatentati , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('1' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('0' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(Tipo_di_cambio ) THEN DO;
_ARBFMT_14 = PUT( Tipo_di_cambio , $14.);
%DMNORMIP( _ARBFMT_14);
IF _ARBFMT_14 IN ('AUTOMATICO' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_14 IN ('MANUALE' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
_BRANCH_ = -1;
IF NOT MISSING(REP_Emissioni_di_CO2 ) AND
REP_Emissioni_di_CO2 < 168.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(REP_Emissioni_di_CO2 ) AND
168.5 <= REP_Emissioni_di_CO2 THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(REP_Consumo_Carburante_Totale ) THEN
DO;
IF REP_Consumo_Carburante_Totale < 6.95 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 6.95 <= REP_Consumo_Carburante_Totale
THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(REP_Cilindrata ) THEN DO;
IF REP_Cilindrata < 1996.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 1996.5 <= REP_Cilindrata THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 2;
IF _BRANCH_ EQ 1 THEN DO;
P_Porte5 = 0.95348837209302;
P_Porte3 = 0.04651162790697;
Q_Porte5 = 0.95348837209302;
Q_Porte3 = 0.04651162790697;
I_Porte = '5';
U_Porte = 5;
END;
ELSE DO;
P_Porte5 = 0.125;
P_Porte3 = 0.875;
Q_Porte5 = 0.125;
Q_Porte3 = 0.875;
I_Porte = '3';
U_Porte = 3;
END;
END;
ELSE DO;
P_Porte5 = 0.36842105263157;
P_Porte3 = 0.63157894736842;
Q_Porte5 = 0.36842105263157;
Q_Porte3 = 0.63157894736842;
I_Porte = '3';
U_Porte = 3;
END;
END;
ELSE DO;
P_Porte5 = 0.99724441995039;
P_Porte3 = 0.0027555800496;
Q_Porte5 = 0.99724441995039;
Q_Porte3 = 0.0027555800496;
I_Porte = '5';
U_Porte = 5;
END;
END;
END;
****************************************************************;
****** END OF DECISION TREE SCORING CODE ******;
****************************************************************;
*;
* ASSIGN VALUE TO: Porte;
*;
length _format200 $200;
drop _format200;
_format200 = strip(I_Porte);
if _format200="5" then IMP_Porte = 5;
else
if _format200="3" then IMP_Porte = 3;
END;
